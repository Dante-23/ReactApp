Add input sanitization. 
Add proper checks for different HTTP responses and handle accordingly. 
